<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ShowGo Slideshow</title>
  <script src="https://cdn.tailwindcss.com"></script>
  {#
  <link rel="stylesheet" href="{{ url_for('static', filename='css/slideshow.css') }}"> #}
  <style>
    /* Basic styles for full screen and elements */
    html,
    body {
      height: 100%;
      margin: 0;
      padding: 0;
      overflow: hidden;
      /* Prevent scrollbars */
      background-color: #000;
      /* Black background */
      color: #fff;
      /* Default white text */
      font-family: sans-serif;
    }

    #slideshow-container {
      position: relative;
      width: 100%;
      height: 100%;
    }

    .slide-image {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: contain;
      /* Or 'cover', depending on desired effect */
      opacity: 0;
      transition: opacity 1s ease-in-out;
      /* Default fade transition time */
      background-color: #000;
      /* Ensure background is black during transitions */
    }

    .slide-image.active {
      opacity: 1;
    }

    /* Widget container styling */
    #widget-container {
      position: absolute;
      bottom: 20px;
      left: 20px;
      right: 20px;
      display: flex;
      justify-content: space-between;
      align-items: flex-end;
      /* Align items to bottom */
      z-index: 10;
      pointer-events: none;
      /* Allow clicks to pass through if needed */
      text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.7);
    }

    /* Individual widget styling */
    .widget {
      background-color: rgba(0, 0, 0, 0.5);
      /* Semi-transparent background */
      padding: 0.5rem 1rem;
      border-radius: 0.375rem;
      /* rounded-md */
      font-size: 1.1rem;
      /* Adjust as needed */
      margin: 0 10px;
      /* Spacing between widgets */
    }

    #time-widget {
      /* Specific styling if needed */
    }

    #weather-widget {
      text-align: right;
    }

    #rss-widget {
      position: absolute;
      bottom: 80px;
      /* Position above other widgets */
      left: 20px;
      right: 20px;
      background-color: rgba(0, 0, 0, 0.5);
      padding: 0.5rem 1rem;
      border-radius: 0.375rem;
      font-size: 1rem;
      text-align: center;
      z-index: 11;
    }

    #rss-widget ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    #rss-widget li {
      margin-bottom: 0.25rem;
    }

    /* Watermark styling */
    #watermark {
      position: absolute;
      z-index: 20;
      background-color: rgba(0, 0, 0, 0.5);
      padding: 0.25rem 0.5rem;
      border-radius: 0.25rem;
      font-size: 0.9rem;
      pointer-events: none;
      /* Default position (bottom-right) - JS will override */
      bottom: 10px;
      right: 10px;
    }
  </style>
</head>

<body>
  <div id="slideshow-container">
  </div>

  {% if config.watermark.enabled %}
  <div id="watermark">{{ config.watermark.text }}</div>
  {% endif %}

  <div id="widget-container">
    {% if config.widgets.time.enabled %}
    <div id="time-widget" class="widget">--:--:--</div>
    {% endif %}

    {# Check if enabled AND data was successfully fetched #}
    {% if config.widgets.weather.enabled and weather %}
    <div id="weather-widget" class="widget">
      {# Basic weather display - customize as needed #}
      {{ weather.name }}: {{ weather.main.temp | round(0) }}Â°F, {{ weather.weather[0].description }}
    </div>
    {# Display error only if enabled but fetch failed #}
    {% elif config.widgets.weather.enabled and not weather %}
    <div id="weather-widget" class="widget text-red-400">Weather unavailable</div>
    {% endif %}
  </div> {# Check if enabled AND data was successfully fetched/parsed #}
  {% if config.widgets.rss.enabled and rss_headlines %}
  <div id="rss-widget">
    <ul>
      {# Display first headline initially - JS will cycle #}
      {% if rss_headlines %}
      <li>{{ rss_headlines[0].title }}</li>
      {% endif %}
    </ul>
  </div>
  {# Display error only if enabled but fetch failed or no entries #}
  {% elif config.widgets.rss.enabled and not rss_headlines %}
  <div id="rss-widget" class="widget text-red-400">RSS Feed unavailable</div>
  {% endif %}


  <script>
    // Pass data from Flask/Jinja to JavaScript
    // Ensure correct JS object syntax with embedded Jinja
    const slideshowData = {
      images: {{ images | tojson }},
    duration: {{ config.slideshow.duration_seconds * 1000 }},
    transitionEffect: {{ config.slideshow.transition_effect | tojson }},
    imageOrder: {{ config.slideshow.image_order | tojson }},
    imageBaseUrl: {{ url_for('serve_uploaded_image', filename = '') | tojson }},
    widgets: {
      time: {{ config.widgets.time.enabled | tojson }},
      watermark: {
        enabled: {{ config.watermark.enabled | tojson }},
        text: {{ config.watermark.text | tojson }},
        position: {{ config.watermark.position | tojson }},
        move: {{ config.watermark.move | tojson }}
      },
      rss: {
        enabled: {{ config.widgets.rss.enabled | tojson }},
        headlines: {{ rss_headlines | tojson }}
      }
      // Weather data is displayed server-side initially
    }
        };
    // console.log("Slideshow Data:", slideshowData); // Uncomment to verify in console
  </script>

  <script src="{{ url_for('static', filename='js/slideshow.js') }}"></script>
</body>

</html>